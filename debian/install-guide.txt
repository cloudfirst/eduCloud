##############################
# 1. prepare /storage
##############################
sudo mkdir /var/log/educloud
sudo mkdir /storage/
cd /storage
sudo mkdir images VMs config
# copy image to /storage/images
# create /storage/config/clc.conf, cc.conf

#############################
# 2. prepare rabbitmq
#############################
# make rabbitmq accept connection from outside
0. add a new user and set it permissions:
   sudo rabbitmqctl add_user luhya luhya
   sudo rabbitmqctl set_permissions luhya  ".*" ".*" ".*"
1. enable web management console for rabbitmq
   /usr/lib/rabbitmq/lib/rabbitmq_server-3.2.4/sbin/rabbitmq-plugins list
   sudo /usr/lib/rabbitmq/lib/rabbitmq_server-3.2.4/sbin/rabbitmq-plugins enable rabbitmq_management
   sudo service rabbitmq-server restart
   http://localhost:55672

############################
# 3. prepare rsync
############################
0. install modified version of rsyncd into CC and NC
1. start rsyncd daemon

############################
# 4. system init
############################
4.1 clear all tables
BEGIN;

delete from auth_group;
delete from auth_group_permissions;
delete from auth_user;
delete from auth_user_groups;
delete from auth_user_user_permission;
DROP TABLE `clc_ectasktransactionauth`;
DROP TABLE `clc_ectasktransaction`;
DROP TABLE `clc_ecvds_auth`;
DROP TABLE `clc_ecvds`;
DROP TABLE `clc_ecvss_auth`;
DROP TABLE `clc_ecvss`;
DROP TABLE `clc_ecvapp_auth`;
DROP TABLE `clc_ecvapp`;
DROP TABLE `clc_ecimages_auth`;
DROP TABLE `clc_ecimages`;
DROP TABLE `clc_echosts_auth`;
DROP TABLE `clc_echosts`;
DROP TABLE `clc_ecccresources`;
DROP TABLE `clc_ecclusternetmode`;
DROP TABLE `clc_ecservers_auth`;
DROP TABLE `clc_ecservers`;
DROP TABLE `clc_ecvmtypes`;
DROP TABLE `clc_ecserverrole`;
DROP TABLE `clc_ecvmusages`;
DROP TABLE `clc_ecostypes`;
DROP TABLE `clc_ecrbac`;
DROP TABLE `clc_ecauthpath`;
DROP TABLE `clc_ecaccount`;

COMMIT;

4.2 create supper user
python manage.py createsuperuser --username=luhya --noinput --email luhya@hoe.com
python manage.py changepassword luhya

4.3 add role to super user luhya
./init_data.sh

4.5 manually delete duplicated records.

-------------------------------------
incoming coding work
-------------------------------------
1. Done. debug VM run/stop at different network configuration
   - rvd
   - vs { manual, public, private }
2. Done. add image version management, for pre-process of image download & submit
3. add lvd, rvd, vss instance creation wizard, one by one and batch creation
   - and modify & delete instance
4. add logic on both walrus, cc, nc to check
   - is it stay wither others ?
   - for pre-process of image download & submit
5. Done. add account management , and support chinese
6. Done. add auth management 
7. add machine & vm status report & display
8. delete tasks
9. support iptable & dhcp automatically for new instance
